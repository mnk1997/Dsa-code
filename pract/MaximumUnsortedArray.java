package in.cdac.pract;

import java.util.ArrayList;
import java.util.Arrays;

public class MaximumUnsortedArray {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		/*
		 * for(int ele:subUnsort(new ArrayList<Integer>(Arrays.asList(1, 1, 10, 10, 15,
		 * 10, 15, 10, 10, 15, 10, 15 )))) { System.out.println(ele); }
		 */
		/*
		 * for(int ele:subUnsort(new ArrayList<Integer>(Arrays.asList(4, 15, 4, 4, 15,
		 * 18, 20 )))) { System.out.println(ele); }
		 */
		ArrayList<Integer> ip=new ArrayList<>(Arrays.asList(5, 7, 11, 15, 15, 19, 20, 26, 40, 41, 48, 48, 50, 54, 59, 60, 60, 70, 70, 72, 75, 76, 77, 83, 89, 92, 94, 96, 97, 99, 104, 105, 105, 105, 106, 108, 110, 113, 117, 128, 134, 138, 139, 146, 146, 154, 159, 159, 172, 185, 188, 191, 193, 195, 198, 201, 213, 222, 228, 233, 242, 247, 248, 248, 259, 270, 274, 280, 280, 288, 293, 294, 294, 300, 304, 310, 314, 315, 317, 319, 327, 328, 329, 331, 340, 352, 354, 356, 365, 365, 378, 378, 387, 390, 395, 397, 398, 398, 399, 408, 409, 413, 418, 418, 426, 429, 434, 443, 450, 455, 470, 479, 483, 490, 495, 497, 497, 499, 509, 510, 515, 519, 519, 524, 531, 531, 538, 542, 543, 548, 561, 574, 587, 589, 593, 598, 599, 601, 604, 607, 622, 629, 635, 640, 643, 644, 644, 646, 650, 655, 666, 689, 690, 692, 699, 705, 708, 709, 710, 712, 717, 718, 722, 725, 725, 729, 732, 734, 744, 748, 753, 758, 765, 770, 772, 773, 777, 780, 784, 786, 801, 806, 816, 821, 823, 823, 827, 832, 832, 839, 847, 854, 866, 868, 874, 875, 880, 884, 887, 893, 894, 894, 899, 901, 901, 906, 908, 914, 916, 921, 927, 929, 934, 937, 947, 955, 959, 961, 962, 965, 969, 972, 974, 983, 992, 995, 999, 1009, 1014, 1015, 1020, 1031, 1034, 1035, 1040, 1043, 1053, 1054, 1056, 1057, 1060, 1065, 1070, 1083, 1093, 1093, 1095, 1099, 1109, 1110, 1113, 1116, 1119, 1124, 1129, 1132, 1133, 1137, 1149, 1149, 1155, 1156, 1163, 1163, 1166, 1166, 1168, 1180, 1188, 1198, 1199, 1200, 1207, 1208, 1211, 1217, 1220, 1221, 1222, 1236, 1239, 1243, 1248, 1250, 1250, 1253, 1256, 1257, 1258, 1261, 1263, 1268, 1273, 1274, 1274, 1279, 1283, 1288, 1289, 1301, 1301, 1302, 1306, 1316, 1317, 1318, 1320, 1320, 1321, 1322, 1326, 1329, 1331, 1333, 1336, 1338, 1339, 1344, 1346, 1348, 1354, 1370, 1372, 1379, 1381, 1387, 1396, 1398, 1398, 1401, 1407, 1427, 1433, 1435, 1444, 1449, 1461, 1467, 1468, 1471, 1471, 1485, 1490, 1493, 1498, 1505, 1513, 1516, 1518, 1518, 1527, 1529, 1530, 1549, 1553, 1559, 1567, 1571, 1575, 1576, 1577, 1581, 1584, 1587, 1595, 1602, 1609, 1617, 1618, 1623, 1629, 1631, 1631, 1635, 1647, 1649, 1653, 1653, 1656, 1659, 1660, 1667, 1673, 1677, 1686, 1698, 1698, 1703, 1712, 1714, 1718, 1723, 1725, 1726, 1728, 1730, 1736, 1751, 1752, 1761, 1770, 1771, 1772, 1786, 1789, 1790, 1795, 1796, 1796, 1796, 1798, 1799, 1805, 1812, 1827, 1831, 1833, 1834, 1836, 1837, 1849, 1852, 1860, 1861, 1862, 1863, 1864, 1866, 1867, 1871, 1873, 1876, 1881, 1884, 1885, 1889, 1908, 1912, 1913, 1918, 1919, 1920, 1923, 1925, 1925, 1927, 1928, 1932, 1937, 1945, 1948, 1948, 1949, 1952, 1965, 1967, 1968, 1980, 1981, 1984, 1985, 1994, 1997, 2000, 2007, 2014, 2015, 2018, 2025, 2035, 2040, 2043, 2046, 2048, 2049, 2049, 2050, 2055, 2065, 2066, 2068, 2072, 2074, 2086, 2088, 2093, 2094, 2096, 2098, 2106, 2108, 2114, 2115, 2117, 2122, 2123, 2127, 2128, 2131, 2133, 2133, 2134, 2137, 2142, 2147, 2148, 2155, 2172, 2184, 2197, 2204, 2206, 2214, 2218, 2219, 2220, 2222, 2228, 2231, 2243, 2244, 2245, 2245, 2249, 2255, 2255, 2258, 2263, 2265, 2266, 2279, 2282, 2285, 2295, 2303, 2307, 2309, 2310, 2314, 2320, 2326, 2329, 2330, 2364, 2366, 2367, 2372, 2373, 2378, 2394, 2395, 2395, 2397, 2402, 2402, 2403, 2414, 2421, 2427, 2428, 2433, 2444, 2449, 2455, 2459, 2462, 2472, 2472, 2484, 2495, 2501, 2505, 2510, 2511, 2515, 2518, 2533, 2535, 2537, 2540, 2570, 2572, 2573, 2573, 2575, 2577, 2581, 2581, 2583, 2584, 2592, 2593, 2609, 2610, 2618, 2628, 2629, 2634, 2638, 2643, 2645, 2646, 2649, 2662, 2672, 2673, 2676, 2677, 2680, 2688, 2693, 2697, 2698, 2699, 2706, 2708, 2709, 2710, 2717, 2727, 2736, 2739, 2742, 2743, 2746, 2756, 2769, 2775, 2783, 2792, 2793, 2800, 2810, 2816, 2818, 2823, 2827, 2828, 2832, 2835, 2835, 2839, 2839, 2840, 2843, 2845, 2858, 2859, 2861, 2867, 2868, 2871, 2886, 2887, 2891, 2896, 2897, 2903, 2908, 2920, 2920, 2921, 2929, 2934, 2934, 2936, 2937, 2937, 2941, 2943, 2944, 2944, 2946, 2946, 2957, 2958, 2965, 2966, 2966, 2966, 2970, 2974, 2975, 2982, 2989, 2991, 2995, 3012, 3024, 3028, 3034, 3037, 3037, 3039, 3039, 3048, 3050, 3053, 3055, 3059, 3060, 3061, 3061, 3073, 3077, 3084, 3093, 3102, 3112, 3113, 3120, 3122, 3124, 3125, 3127, 3128, 3128, 3129, 3132, 3133, 3134, 3143, 3147, 3147, 3159, 3164, 3173, 3178, 3181, 3183, 3185, 3191, 3194, 3198, 3212, 3218, 3218, 3219, 3231, 3233, 3242, 3242, 3252, 3254, 3272, 3277, 3279, 3283, 3284, 3291, 3294, 3295, 3297, 3297, 3298, 3303, 3314, 3316, 3319, 3331, 3336, 3343, 3360, 3368, 3372, 3372, 3374, 3375, 3375, 3376, 3379, 3383, 3384, 3389, 3400, 3401, 3402, 3404, 3405, 3408, 3409, 3409, 3420, 3420, 3432, 3438, 3439, 3440, 3444, 3447, 3452, 3457, 3467, 3477, 3479, 3481, 3485, 3489, 3489, 3490, 3508, 3514, 3515, 3515, 3517, 3518, 3522, 3530, 3530, 3531, 3537, 3544, 3547, 3549, 3558, 3559, 3569, 3571, 3571, 3573, 3576, 3578, 3582, 3589, 3592, 3593, 3616, 3620, 3622, 3627, 3629, 3635, 3647, 3651, 3653, 3653, 3656, 3660, 3669, 3678, 3680, 3681, 3682, 3685, 3687, 3689, 3690, 3690, 3695, 3696, 3701, 3703, 3709, 3714, 3719, 3719, 3719, 3728, 3736, 3740, 3757, 3767, 3767, 3772, 3772, 3780, 3787, 3802, 3805, 3810, 3812, 3813, 3827, 3832, 3838, 3845, 3858, 3861, 3864, 3865, 3868, 3870, 3881, 3890, 3897, 3900, 3901, 3903, 3908, 3912, 3914, 3917, 3922, 3924, 3924, 3925, 3935, 3936, 3938, 3939, 3942, 3944, 3944, 3954, 3961, 3965, 3965, 3967, 3971, 3971, 3973, 3975, 3984, 3987, 3989, 4015, 4017, 4020, 4039, 4044, 4045, 4068, 4069, 4079, 4080, 4080, 4096, 4096, 4099, 4102, 4108, 4108, 4112, 4113, 4126, 4140, 4145, 4151, 4163, 4166, 4177, 4178, 4193, 4195, 4201, 4202, 4206, 4208, 4209, 4210, 4211, 4212, 4213, 4219, 4221, 4222, 4224, 4226, 4236, 4237, 4238, 4239, 4242, 4244, 4248, 4248, 4250, 4250, 4250, 4252, 4254, 4259, 4261, 4263, 4264, 4265, 4265, 4269, 4273, 4277, 4286, 4289, 4300, 4308, 4308, 4309, 4310, 4315, 4326, 4330, 4332, 4338, 4340, 4343, 4350, 4353, 4355, 4358, 4367, 4369, 4370, 4373, 4377, 4384, 4392, 4392, 4394, 4401, 4414, 4418, 4430, 4437, 4441, 4444, 4458, 4468, 4469, 4469, 4469, 4470, 4472, 4473, 4474, 4475, 4479, 4487, 4490, 4501, 4503, 4506, 4515, 4535, 4537, 4540, 4548, 4550, 4553, 4553, 4553, 4579, 4580, 4591, 4597, 4599, 4604, 4607, 4616, 4617, 4619, 4628, 4631, 4633, 4633, 4638, 4641, 4643, 4650, 4654, 4658, 4662, 4668, 4671, 4672, 4674, 4679, 4683, 4685, 4685, 4691, 4694, 4697, 4703, 4705, 4710, 4713, 4714, 4720, 4725, 4736, 4745, 4746, 4748, 4752, 4754, 4754, 4758, 4763, 4769, 4771, 4778, 4780, 4785, 4785, 4785, 4791, 4804, 4811, 4814, 4819, 4819, 4825, 4827, 4832, 4834, 4834, 4843, 4843, 4850, 4853, 4863, 4864, 4867, 4871, 4871, 4872, 4872, 4877, 4880, 4881, 4885, 4886, 4890, 4891, 4893, 4899, 4900, 4901, 4906, 4912, 4916, 4921, 4924, 4926, 4935, 4938, 4941, 4948, 4949, 4950, 4951, 4953, 4965, 4971, 4971, 4980, 4982, 4986, 4993, 4998, 5004, 5025, 5033, 5036, 5038, 5039, 5042, 5051, 5055, 5059, 5071, 5078, 5079, 5080, 5084, 5087, 5102, 5112, 5113, 5113, 5114, 5123, 5129, 5130, 5139, 5147, 5154, 5156, 5162, 5164, 5177, 5179, 5181, 5183, 5185, 5185, 5187, 5191, 5193, 5195, 5197, 5198, 5210, 5211, 5212, 5217, 5224, 5225, 5238, 5240, 5240, 5241, 5243, 5246, 5254, 5257, 5259, 5260, 5268, 5268, 5273, 5274, 5278, 5283, 5285, 5291, 5302, 5309, 5316, 5323, 5348, 5350, 5355, 5356, 5358, 5359, 5370, 5371, 5378, 5385, 5388, 5395, 5404, 5406, 5413, 5415, 5417, 5417, 5418, 5424, 5425, 5428, 5429, 5429, 5433, 5434, 5434, 5443, 5458, 5466, 5471, 5478, 5478, 5480, 5486, 5488, 5489, 5493, 5507, 5509, 5511, 5516, 5517, 5520, 5529, 5534, 5537, 5538, 5541, 5542, 5542, 5545, 5547, 5547, 5551, 5560, 5561, 5568, 5572, 5573, 5581, 5581, 5582, 5592, 5599, 5601, 5601, 5625, 5638, 5643, 5643, 5645, 5647, 5649, 5650, 5655, 5658, 5660, 5685, 5688, 5697, 5698, 5708, 5710, 5713, 5717, 5720, 5728, 5729, 5730, 5730, 5732, 5748, 5750, 5752, 5758, 5759, 5761, 5765, 5765, 5772, 5781, 5783, 5795, 5798, 5799, 5800, 5821, 5822, 5828, 5834, 5844, 5856, 5856, 5861, 5862, 5867, 5874, 5876, 5878, 5881, 5884, 5889, 5889, 5897, 5897, 5900, 5901, 5903, 5916, 5925, 5927, 5930, 5933, 5935, 5937, 5940, 5941, 5945, 5946, 5947, 5948, 5950, 5954, 5955, 5957, 5961, 5965, 5966, 5966, 5976, 5976, 5982, 5987, 5992, 5996, 5999, 6003, 6007, 6007, 6008, 6015, 6021, 6026, 6042, 6044, 6048, 6049, 6057, 6058, 6060, 6061, 6069, 6079, 6081, 6082, 6099, 6103, 6106, 6114, 6117, 6117, 6131, 6136, 6145, 6162, 6166, 6174, 6174, 6175, 6197, 6198, 6201, 6205, 6207, 6211, 6215, 6215, 6226, 6232, 6242, 6243, 6251, 6252, 6253, 6254, 6261, 6266, 6268, 6278, 6278, 6283, 6284, 6285, 6302, 6318, 6322, 6331, 6332, 6333, 6344, 6351, 6352, 6358, 6361, 6363, 6371, 6382, 6387, 6394, 6400, 6407, 6408, 6410, 6416, 6424, 6434, 6437, 6442, 6443, 6443, 6445, 6446, 6450, 6450, 6464, 6470, 6478, 6485, 6487, 6495, 6497, 6499, 6520, 6525, 6532, 6537, 6545, 6550, 6550, 6556, 6557, 6561, 6568, 6572, 6575, 6576, 6580, 6584, 6585, 6585, 6588, 6596, 6598, 6601, 6602, 6607, 6608, 6609, 6612, 6614, 6615, 6615, 6621, 6631, 6634, 6645, 6651, 6651, 6653, 6658, 6662, 6663, 6664, 6677, 6679, 6679, 6686, 6691, 6696, 6699, 6703, 6704, 6718, 6721, 6724, 6728, 6729, 6730, 6731, 6733, 6736, 6736, 6736, 6738, 6739, 6740, 6740, 6741, 6743, 6751, 6756, 6761, 6761, 6762, 6769, 6774, 6775, 6783, 6813, 6819, 6821, 6821, 6822, 6833, 6834, 6834, 6835, 6837, 6838, 6838, 6844, 6848, 6856, 6856, 6864, 6868, 6868, 6884, 6888, 6890, 6899, 6900, 6903, 6905, 6906, 6909, 6910, 6913, 6920, 6922, 6926, 6930, 6937, 6941, 6951, 6961, 6961, 6963, 6965, 6971, 6973, 6978, 6985, 6986, 6989, 6995, 6998, 7000, 7018, 7019, 7019, 7023, 7034, 7045, 7058, 7061, 7065, 7066, 7067, 7070, 7073, 7081, 7081, 7081, 7085, 7091, 7103, 7103, 7109, 7115, 7115, 7122, 7123, 7126, 7126, 7127, 7131, 7143, 7145, 7153, 7157, 7160, 7174, 7176, 7178, 7183, 7184, 7188, 7192, 7195, 7208, 7222, 7234, 7236, 7239, 7242, 7245, 7250, 7254, 7261, 7262, 7268, 7273, 7275, 7280, 7289, 7293, 7295, 7308, 7311, 7313, 7314, 7318, 7323, 7329, 7331, 7337, 7351, 7361, 7362, 7374, 7376, 7381, 7388, 7390, 7396, 7401, 7414, 7414, 7415, 7420, 7430, 7432, 7434, 7435, 7436, 7437, 7449, 7449, 7458, 7460, 7464, 7472, 7472, 7481, 7482, 7485, 7487, 7491, 7491, 7492, 7493, 7494, 7495, 7500, 7504, 7511, 7523, 7526, 7531, 7533, 7534, 7537, 7538, 7546, 7560, 7576, 7588, 7588, 7588, 7589, 7593, 7595, 7596, 7601, 7602, 7603, 7604, 7604, 7608, 7609, 7613, 7619, 7622, 7625, 7630, 7630, 7632, 7632, 7638, 7640, 7642, 7644, 7649, 7651, 7662, 7664, 7674, 7682, 7684, 7685, 7692, 7693, 7697, 7700, 7704, 7706, 7711, 7711, 7711, 7713, 7721, 7722, 7730, 7730, 7734, 7737, 7738, 7740, 7742, 7746, 7746, 7754, 7754, 7756, 7760, 7768, 7769, 7770, 7773, 7774, 7778, 7785, 7794, 7805, 7807, 7814, 7819, 7820, 7820, 7821, 7825, 7827, 7828, 7839, 7845, 7846, 7857, 7858, 7858, 7865, 7870, 7878, 7878, 7882, 7882, 7883, 7885, 7886, 7888, 7899, 7899, 7903, 7909, 7916, 7921, 7927, 7932, 7937, 7945, 7954, 7955, 7961, 7966, 7970, 7979, 7987, 7988, 7994, 7999, 8003, 8005, 8027, 8028, 8034, 8036, 8037, 8042, 8046, 8050, 8066, 8067, 8073, 8076, 8079, 8083, 8085, 8086, 8088, 8089, 8091, 8099, 8101, 8109, 8109, 8117, 8117, 8120, 8122, 8130, 8131, 8135, 8140, 8143, 8148, 8152, 8161, 8168, 8175, 8180, 8182, 8191, 8195, 8198, 8204, 8205, 8207, 8209, 8209, 8213, 8215, 8223, 8224, 8224, 8228, 8230, 8231, 8236, 8238, 8239, 8241, 8243, 8244, 8245, 8245, 8250, 8251, 8251, 8261, 8267, 8273, 8278, 8285, 8293, 8295, 8317, 8318, 8319, 8329, 8333, 8336, 8338, 8347, 8355, 8357, 8359, 8360, 8361, 8363, 8363, 8367, 8368, 8370, 8373, 8379, 8380, 8380, 8381, 8381, 8388, 8399, 8400, 8411, 8412, 8412, 8414, 8424, 8428, 8437, 8439, 8449, 8450, 8452, 8461, 8467, 8467, 8470, 8472, 8475, 8475, 8479, 8483, 8486, 8488, 8496, 8502, 8509, 8512, 8516, 8517, 8520, 8524, 8530, 8535, 8535, 8543, 8549, 8550, 8550, 8564, 8574, 8575, 8586, 8589, 8592, 8595, 8601, 8602, 8605, 8607, 8612, 8621, 8623, 8625, 8629, 8634, 8636, 8638, 8644, 8644, 8646, 8651, 8655, 8656, 8661, 8661, 8668, 8677, 8679, 8691, 8694, 8699, 8716, 8723, 8724, 8732, 8735, 8738, 8738, 8755, 8755, 8758, 8758, 8760, 8768, 8770, 8771, 8772, 8777, 8787, 8791, 8795, 8800, 8804, 8815, 8819, 8828, 8833, 8835, 8835, 8836, 8850, 8857, 8859, 8861, 8865, 8872, 8876, 8884, 8885, 8886, 8889, 8889, 8894, 8895, 8896, 8900, 8901, 8914, 8918));
		System.out.println("ip size "+ip.size());
		for(int ele:subUnsort(ip))
		{
			System.out.println(ele);
		}

	}
	public static ArrayList<Integer> subUnsort(ArrayList<Integer> A) {
        //using the concept of insertion sort to find the maximum subarray length
        ArrayList<Integer> op=new ArrayList<>(2);
        op.add(-1);
        op.add(-1);
        int maxLengthOfSubArrayUnordered=0;
        int last=-1;
        int start=-1;
        for(int i=1;i<A.size();i++)
        {
              int j=i;
              if(j>0 && A.get(j-1)>A.get(j))
              {
                  int temp=A.get(j);
                 
                  while(j>0 && A.get(j-1)>temp)
                  {
                       if(last==-1 || j>last)
                      {
                    	 //  System.out.println(" last is updated from "+last +"   to "+j);
                          last=j;
                          op.set(1, j);
                         // A.set(1,j);
                      }
                      A.set(j,A.get(j-1));
                      j--;
                     
                  }
                  if(start==-1 || j<start)
                  {
                	 // System.out.println(" start is updated from "+start +"   to "+j);
                	  start=j;
                	  op.set(0,start);
                  }
                 
                  A.set(j,temp);
                  maxLengthOfSubArrayUnordered=op.get(1)-op.get(0)+1;
              }
              
              //System.out.println(op.get(0) +"  "+op.get(1));
             // System.out.println("----------------------------------------------------------------------------------------");
        }
        if(maxLengthOfSubArrayUnordered==0)
        {
        	System.out.println("REmoving "+op.get(1));
            op.remove(1);
            
        }
        return op;
    }
}
